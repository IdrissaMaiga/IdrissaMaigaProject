services:
  # API Service
  api-service:
    build:
      context: .
      dockerfile: Backend/ProductAssistant.Api/Dockerfile
    container_name: product-assistant-api
    ports:
      - "5000:8080"
    environment:
      - ASPNETCORE_ENVIRONMENT=Development
      - ASPNETCORE_URLS=http://+:8080
      - Database__Path=/app/data/productassistant.db
      - ScrapingService__Url=http://scraping-service:8080
      - AIService__Url=http://ai-service:8080
    volumes:
      - api-db-data:/app/data
    networks:
      - product-assistant-network
    depends_on:
      scraping-service:
        condition: service_started
      ai-service:
        condition: service_started
    restart: unless-stopped

  # Scraping Service
  scraping-service:
    build:
      context: .
      dockerfile: Backend/ProductAssistant.ScrapingService/Dockerfile
    container_name: product-assistant-scraping
    ports:
      - "5002:8080"
    environment:
      - ASPNETCORE_ENVIRONMENT=Development
      - ASPNETCORE_URLS=http://+:8080
    networks:
      - product-assistant-network
    restart: unless-stopped

  # AI Service
  ai-service:
    build:
      context: .
      dockerfile: Backend/ProductAssistant.AIService/Dockerfile
    container_name: product-assistant-ai
    ports:
      - "5003:8080"
    environment:
      - ASPNETCORE_ENVIRONMENT=Development
      - ASPNETCORE_URLS=http://+:8080
      - Database__Path=/app/data/productassistant.db
      - ScrapingService__Url=http://scraping-service:8080
      - ServiceOptions__ApiServiceUrl=http://api-service:8080
    volumes:
      - ai-db-data:/app/data
    networks:
      - product-assistant-network
    depends_on:
      scraping-service:
        condition: service_started
    restart: unless-stopped

networks:
  product-assistant-network:
    driver: bridge

volumes:
  api-db-data:
  ai-db-data:
